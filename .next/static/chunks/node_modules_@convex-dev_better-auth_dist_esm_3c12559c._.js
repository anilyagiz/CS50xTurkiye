(globalThis.TURBOPACK || (globalThis.TURBOPACK = [])).push([typeof document === "object" ? document.currentScript : undefined,
"[project]/node_modules/@convex-dev/better-auth/dist/esm/client/createSchema.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

// Manually add fields to index on for schema generation,
// all fields in the schema specialFields are automatically indexed
__turbopack_context__.s([
    "createSchema",
    ()=>createSchema,
    "indexFields",
    ()=>indexFields
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$polyfills$2f$process$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = /*#__PURE__*/ __turbopack_context__.i("[project]/node_modules/next/dist/build/polyfills/process.js [app-client] (ecmascript)");
const indexFields = {
    account: [
        "accountId",
        [
            "accountId",
            "providerId"
        ],
        [
            "providerId",
            "userId"
        ]
    ],
    rateLimit: [
        "key"
    ],
    session: [
        "expiresAt",
        [
            "expiresAt",
            "userId"
        ]
    ],
    verification: [
        "expiresAt",
        "identifier"
    ],
    user: [
        [
            "email",
            "name"
        ],
        "name",
        "userId"
    ],
    passkey: [
        "credentialID"
    ],
    apikey: [
        "key"
    ],
    member: [
        [
            "organizationId",
            "userId"
        ]
    ],
    invitation: [
        [
            "email",
            "organizationId",
            "status"
        ],
        [
            "organizationId",
            "status"
        ]
    ],
    oauthConsent: [
        [
            "clientId",
            "userId"
        ]
    ],
    ssoProvider: [
        "organizationId",
        "domain"
    ],
    subscription: [
        "stripeSubscriptionId",
        "stripeCustomerId",
        "referenceId"
    ]
};
// Return map of unique, sortable, and reference fields
const specialFields = (tables)=>Object.fromEntries(Object.entries(tables).map((param)=>{
        let [key, table] = param;
        const fields = Object.fromEntries(Object.entries(table.fields).map((param)=>{
            let [fieldKey, field] = param;
            return [
                fieldKey,
                {
                    ...field.sortable ? {
                        sortable: true
                    } : {},
                    ...field.unique ? {
                        unique: true
                    } : {},
                    ...field.references ? {
                        references: field.references
                    } : {}
                }
            ];
        }).filter((param)=>{
            let [_key, value] = param;
            return typeof value === "object" ? Object.keys(value).length > 0 : true;
        }));
        return [
            key,
            fields
        ];
    }).filter((param)=>{
        let [_key, value] = param;
        return typeof value === "object" ? Object.keys(value).length > 0 : true;
    }));
const mergedIndexFields = (tables)=>Object.fromEntries(Object.entries(tables).map((param)=>{
        let [key] = param;
        const manualIndexes = indexFields[key] || [];
        const specialFieldIndexes = Object.keys(specialFields(tables)[key] || {}).filter((index)=>!manualIndexes.some((m)=>Array.isArray(m) ? m[0] === index : m === index));
        return [
            key,
            manualIndexes.concat(specialFieldIndexes)
        ];
    }));
const createSchema = async (param)=>{
    let { file, tables } = param;
    // stop convex esbuild from throwing over this import, only runs
    // in the better auth cli
    const pathImport = "path";
    const path = await __turbopack_context__.A("[project]/node_modules/next/dist/compiled/path-browserify/index.js [app-client] (ecmascript, async loader)");
    const baseName = path.basename(path.resolve(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$polyfills$2f$process$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["default"].cwd(), file !== null && file !== void 0 ? file : ""));
    // if the target directory is named "convex", they're almost definitely
    // generating the schema in the wrong directory, likely would replace the
    // app schema
    if (baseName === "convex") {
        throw new Error("Better Auth schema must be generated in the Better Auth component directory.");
    }
    let code = "// This file is auto-generated. Do not edit this file manually.\n// To regenerate the schema, run:\n// `npx @better-auth/cli generate --output ".concat(file, ' -y`\n\nimport { defineSchema, defineTable } from "convex/server";\nimport { v } from "convex/values";\n\nexport const tables = {\n');
    for(const tableKey in tables){
        var _mergedIndexFields_modelName;
        const table = tables[tableKey];
        const modelName = table.modelName;
        // No id fields in Convex schema
        const fields = Object.fromEntries(Object.entries(table.fields).filter((param)=>{
            let [key] = param;
            return key !== "id";
        }));
        function getType(name, field) {
            const type = field.type;
            const typeMap = {
                string: "v.string()",
                boolean: "v.boolean()",
                number: "v.number()",
                date: "v.number()",
                "number[]": "v.array(v.number())",
                "string[]": "v.array(v.string())"
            };
            return typeMap[type];
        }
        const indexes = ((_mergedIndexFields_modelName = mergedIndexFields(tables)[modelName]) === null || _mergedIndexFields_modelName === void 0 ? void 0 : _mergedIndexFields_modelName.map((index)=>{
            const indexArray = Array.isArray(index) ? index.sort() : [
                index
            ];
            const indexName = indexArray.join("_");
            return '.index("'.concat(indexName, '", ').concat(JSON.stringify(indexArray), ")");
        })) || [];
        const schema = "".concat(modelName, ": defineTable({\n").concat(Object.keys(fields).map((field)=>{
            const attr = fields[field];
            const type = getType(field, attr);
            const optional = (fieldSchema)=>attr.required ? fieldSchema : "v.optional(v.union(v.null(), ".concat(fieldSchema, "))");
            return "    ".concat(field, ": ").concat(optional(type), ",");
        }).join("\n"), "\n  })").concat(indexes.length > 0 ? "\n    ".concat(indexes.join("\n    ")) : "", ",\n");
        code += "  ".concat(schema);
    }
    code += "};\n\nconst schema = defineSchema(tables);\n\nexport default schema;\n";
    return {
        code,
        path: file !== null && file !== void 0 ? file : "./schema.ts",
        overwrite: true
    };
}; //# sourceMappingURL=createSchema.js.map
}),
"[project]/node_modules/@convex-dev/better-auth/dist/esm/client/adapter.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "convexAdapter",
    ()=>convexAdapter
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$adapters$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/better-auth/dist/adapters/index.mjs [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$BuBqXPUp$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__c__as__createAdapter$3e$__ = __turbopack_context__.i("[project]/node_modules/better-auth/dist/shared/better-auth.BuBqXPUp.mjs [app-client] (ecmascript) <export c as createAdapter>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$server$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/convex/dist/esm/server/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$server$2f$components$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/convex/dist/esm/server/components/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$convex$2d$dev$2f$better$2d$auth$2f$dist$2f$esm$2f$client$2f$createSchema$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@convex-dev/better-auth/dist/esm/client/createSchema.js [app-client] (ecmascript)");
;
;
;
const handlePagination = async function(next) {
    let { limit, numItems } = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
    const state = {
        isDone: false,
        cursor: null,
        docs: [],
        count: 0
    };
    const onResult = (result)=>{
        var _result_splitCursor;
        state.cursor = result.pageStatus === "SplitRecommended" || result.pageStatus === "SplitRequired" ? (_result_splitCursor = result.splitCursor) !== null && _result_splitCursor !== void 0 ? _result_splitCursor : result.continueCursor : result.continueCursor;
        if (result.page) {
            state.docs.push(...result.page);
            state.isDone = limit && state.docs.length >= limit || result.isDone;
            return;
        }
        // Update and delete only return a count
        if (result.count) {
            state.count += result.count;
            state.isDone = limit && state.count >= limit || result.isDone;
            return;
        }
        state.isDone = result.isDone;
    };
    do {
        const result = await next({
            paginationOpts: {
                numItems: Math.min(numItems !== null && numItems !== void 0 ? numItems : 200, (limit !== null && limit !== void 0 ? limit : 200) - state.docs.length, 200),
                cursor: state.cursor
            }
        });
        onResult(result);
    }while (!state.isDone)
    return state;
};
const parseWhere = (where)=>{
    return where === null || where === void 0 ? void 0 : where.map((where)=>{
        if (where.value instanceof Date) {
            return {
                ...where,
                value: where.value.getTime()
            };
        }
        return where;
    });
};
const convexAdapter = function(ctx, api) {
    let config = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : {};
    return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$BuBqXPUp$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__c__as__createAdapter$3e$__["createAdapter"])({
        config: {
            adapterId: "convex",
            adapterName: "Convex Adapter",
            debugLogs: config.debugLogs || false,
            disableIdGeneration: true,
            supportsNumericIds: false,
            usePlural: false,
            mapKeysTransformOutput: {
                _id: "id"
            },
            // With supportsDates: false, dates are stored as strings,
            // we convert them to numbers here. This aligns with how
            // Convex stores _creationTime, and avoids a breaking change.
            supportsDates: false,
            customTransformInput: (param)=>{
                let { data, fieldAttributes } = param;
                if (data && fieldAttributes.type === "date") {
                    return new Date(data).getTime();
                }
                return data;
            },
            customTransformOutput: (param)=>{
                let { data, fieldAttributes } = param;
                if (data && fieldAttributes.type === "date") {
                    return new Date(data).getTime();
                }
                return data;
            }
        },
        adapter: (param)=>{
            let { options } = param;
            options.telemetry = {
                enabled: false
            };
            return {
                id: "convex",
                createSchema: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$convex$2d$dev$2f$better$2d$auth$2f$dist$2f$esm$2f$client$2f$createSchema$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createSchema"],
                create: async (param)=>{
                    let { model, data, select } = param;
                    var _config_authFunctions, _config_triggers_model, _config_triggers;
                    if (!("runMutation" in ctx)) {
                        throw new Error("ctx is not a mutation ctx");
                    }
                    const onCreateHandle = ((_config_authFunctions = config.authFunctions) === null || _config_authFunctions === void 0 ? void 0 : _config_authFunctions.onCreate) && ((_config_triggers = config.triggers) === null || _config_triggers === void 0 ? void 0 : (_config_triggers_model = _config_triggers[model]) === null || _config_triggers_model === void 0 ? void 0 : _config_triggers_model.onCreate) ? await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$server$2f$components$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["createFunctionHandle"])(config.authFunctions.onCreate) : undefined;
                    return ctx.runMutation(api.adapter.create, {
                        input: {
                            model,
                            data
                        },
                        select,
                        onCreateHandle: onCreateHandle
                    });
                },
                findOne: async (data)=>{
                    var _data_where;
                    if ((_data_where = data.where) === null || _data_where === void 0 ? void 0 : _data_where.every((w)=>w.connector === "OR")) {
                        for (const w of data.where){
                            const result = await ctx.runQuery(api.adapter.findOne, {
                                ...data,
                                where: parseWhere([
                                    w
                                ])
                            });
                            if (result) {
                                return result;
                            }
                        }
                    }
                    return await ctx.runQuery(api.adapter.findOne, {
                        ...data,
                        where: parseWhere(data.where)
                    });
                },
                findMany: async (data)=>{
                    var _data_where;
                    if (data.offset) {
                        throw new Error("offset not supported");
                    }
                    if ((_data_where = data.where) === null || _data_where === void 0 ? void 0 : _data_where.some((w)=>w.connector === "OR")) {
                        throw new Error("OR connector not supported in findMany");
                    }
                    const result = await handlePagination(async (param)=>{
                        let { paginationOpts } = param;
                        return await ctx.runQuery(api.adapter.findMany, {
                            ...data,
                            where: parseWhere(data.where),
                            paginationOpts
                        });
                    }, {
                        limit: data.limit
                    });
                    return result.docs;
                },
                count: async (data)=>{
                    var _data_where, _result_docs;
                    // Yes, count is just findMany returning a number.
                    if ((_data_where = data.where) === null || _data_where === void 0 ? void 0 : _data_where.some((w)=>w.connector === "OR")) {
                        throw new Error("OR connector not supported in findMany");
                    }
                    const result = await handlePagination(async (param)=>{
                        let { paginationOpts } = param;
                        return await ctx.runQuery(api.adapter.findMany, {
                            ...data,
                            where: parseWhere(data.where),
                            paginationOpts
                        });
                    });
                    var _result_docs_length;
                    return (_result_docs_length = (_result_docs = result.docs) === null || _result_docs === void 0 ? void 0 : _result_docs.length) !== null && _result_docs_length !== void 0 ? _result_docs_length : 0;
                },
                update: async (data)=>{
                    var _data_where;
                    if (!("runMutation" in ctx)) {
                        throw new Error("ctx is not a mutation ctx");
                    }
                    if (((_data_where = data.where) === null || _data_where === void 0 ? void 0 : _data_where.length) === 1 && data.where[0].operator === "eq") {
                        var _config_authFunctions, _config_triggers_data_model, _config_triggers;
                        const onUpdateHandle = ((_config_authFunctions = config.authFunctions) === null || _config_authFunctions === void 0 ? void 0 : _config_authFunctions.onUpdate) && ((_config_triggers = config.triggers) === null || _config_triggers === void 0 ? void 0 : (_config_triggers_data_model = _config_triggers[data.model]) === null || _config_triggers_data_model === void 0 ? void 0 : _config_triggers_data_model.onUpdate) ? await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$server$2f$components$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["createFunctionHandle"])(config.authFunctions.onUpdate) : undefined;
                        return ctx.runMutation(api.adapter.updateOne, {
                            input: {
                                model: data.model,
                                where: parseWhere(data.where),
                                update: data.update
                            },
                            onUpdateHandle: onUpdateHandle
                        });
                    }
                    throw new Error("where clause not supported");
                },
                delete: async (data)=>{
                    var _config_authFunctions, _config_triggers_data_model, _config_triggers;
                    if (!("runMutation" in ctx)) {
                        throw new Error("ctx is not a mutation ctx");
                    }
                    const onDeleteHandle = ((_config_authFunctions = config.authFunctions) === null || _config_authFunctions === void 0 ? void 0 : _config_authFunctions.onDelete) && ((_config_triggers = config.triggers) === null || _config_triggers === void 0 ? void 0 : (_config_triggers_data_model = _config_triggers[data.model]) === null || _config_triggers_data_model === void 0 ? void 0 : _config_triggers_data_model.onDelete) ? await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$server$2f$components$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["createFunctionHandle"])(config.authFunctions.onDelete) : undefined;
                    await ctx.runMutation(api.adapter.deleteOne, {
                        input: {
                            model: data.model,
                            where: parseWhere(data.where)
                        },
                        onDeleteHandle: onDeleteHandle
                    });
                },
                deleteMany: async (data)=>{
                    var _config_authFunctions, _config_triggers_data_model, _config_triggers;
                    if (!("runMutation" in ctx)) {
                        throw new Error("ctx is not a mutation ctx");
                    }
                    const onDeleteHandle = ((_config_authFunctions = config.authFunctions) === null || _config_authFunctions === void 0 ? void 0 : _config_authFunctions.onDelete) && ((_config_triggers = config.triggers) === null || _config_triggers === void 0 ? void 0 : (_config_triggers_data_model = _config_triggers[data.model]) === null || _config_triggers_data_model === void 0 ? void 0 : _config_triggers_data_model.onDelete) ? await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$server$2f$components$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["createFunctionHandle"])(config.authFunctions.onDelete) : undefined;
                    const result = await handlePagination(async (param)=>{
                        let { paginationOpts } = param;
                        return await ctx.runMutation(api.adapter.deleteMany, {
                            input: {
                                ...data,
                                where: parseWhere(data.where)
                            },
                            paginationOpts,
                            onDeleteHandle: onDeleteHandle
                        });
                    });
                    return result.count;
                },
                updateMany: async (data)=>{
                    var _config_authFunctions, _config_triggers_data_model, _config_triggers;
                    if (!("runMutation" in ctx)) {
                        throw new Error("ctx is not an action ctx");
                    }
                    const onUpdateHandle = ((_config_authFunctions = config.authFunctions) === null || _config_authFunctions === void 0 ? void 0 : _config_authFunctions.onUpdate) && ((_config_triggers = config.triggers) === null || _config_triggers === void 0 ? void 0 : (_config_triggers_data_model = _config_triggers[data.model]) === null || _config_triggers_data_model === void 0 ? void 0 : _config_triggers_data_model.onUpdate) ? await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$server$2f$components$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["createFunctionHandle"])(config.authFunctions.onUpdate) : undefined;
                    const result = await handlePagination(async (param)=>{
                        let { paginationOpts } = param;
                        return await ctx.runMutation(api.adapter.updateMany, {
                            input: {
                                ...data,
                                where: parseWhere(data.where)
                            },
                            paginationOpts,
                            onUpdateHandle: onUpdateHandle
                        });
                    });
                    return result.count;
                }
            };
        }
    });
}; //# sourceMappingURL=adapter.js.map
}),
"[project]/node_modules/@convex-dev/better-auth/dist/esm/utils/index.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * @deprecated Just reference variables direct, the component will
 * use other ways to make sure the appropriate variables are available
 */ __turbopack_context__.s([
    "isActionCtx",
    ()=>isActionCtx,
    "isMutationCtx",
    ()=>isMutationCtx,
    "isQueryCtx",
    ()=>isQueryCtx,
    "requireActionCtx",
    ()=>requireActionCtx,
    "requireEnv",
    ()=>requireEnv,
    "requireMutationCtx",
    ()=>requireMutationCtx,
    "requireQueryCtx",
    ()=>requireQueryCtx
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$polyfills$2f$process$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = /*#__PURE__*/ __turbopack_context__.i("[project]/node_modules/next/dist/build/polyfills/process.js [app-client] (ecmascript)");
const requireEnv = (name)=>{
    const value = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$polyfills$2f$process$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["default"].env[name];
    if (value === undefined) {
        throw new Error("Missing environment variable `".concat(name, "`"));
    }
    return value;
};
const isQueryCtx = (ctx)=>{
    return "db" in ctx;
};
const isMutationCtx = (ctx)=>{
    return "db" in ctx && "scheduler" in ctx;
};
const isActionCtx = (ctx)=>{
    return "runAction" in ctx;
};
const requireQueryCtx = (ctx)=>{
    if (!isQueryCtx(ctx)) {
        throw new Error("Query context required");
    }
    return ctx;
};
const requireMutationCtx = (ctx)=>{
    if (!isMutationCtx(ctx)) {
        throw new Error("Mutation context required");
    }
    return ctx;
};
const requireActionCtx = (ctx)=>{
    if (!isActionCtx(ctx)) {
        throw new Error("Action context required");
    }
    return ctx;
}; //# sourceMappingURL=index.js.map
}),
"[project]/node_modules/@convex-dev/better-auth/dist/esm/client/adapterUtils.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "adapterArgsValidator",
    ()=>adapterArgsValidator,
    "adapterWhereValidator",
    ()=>adapterWhereValidator,
    "checkUniqueFields",
    ()=>checkUniqueFields,
    "hasUniqueFields",
    ()=>hasUniqueFields,
    "listOne",
    ()=>listOne,
    "paginate",
    ()=>paginate,
    "selectFields",
    ()=>selectFields
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$swc$2f$helpers$2f$esm$2f$_tagged_template_literal$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@swc/helpers/esm/_tagged_template_literal.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2d$helpers$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/convex-helpers/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/convex/dist/esm/values/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/convex/dist/esm/values/validator.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2d$helpers$2f$server$2f$stream$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/convex-helpers/server/stream.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$common$2d$tags$2f$es$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/common-tags/es/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$common$2d$tags$2f$es$2f$stripIndent$2f$stripIndent$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__default__as__stripIndent$3e$__ = __turbopack_context__.i("[project]/node_modules/common-tags/es/stripIndent/stripIndent.js [app-client] (ecmascript) <export default as stripIndent>");
;
function _templateObject() {
    const data = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$swc$2f$helpers$2f$esm$2f$_tagged_template_literal$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["_"])([
        '\n          Querying without an index on table "',
        '".\n          This can cause performance issues, and may hit the document read limit.\n          To fix, add an index that begins with the following fields in order:\n          [',
        "]\n        "
    ]);
    _templateObject = function() {
        return data;
    };
    return data;
}
;
;
;
;
;
const adapterWhereValidator = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].object({
    field: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].string(),
    operator: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].optional(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].union(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("lt"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("lte"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("gt"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("gte"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("eq"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("in"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("ne"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("contains"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("starts_with"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("ends_with"))),
    value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].union(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].string(), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].number(), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].boolean(), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].array(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].string()), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].array(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].number()), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].null()),
    connector: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].optional(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].union(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("AND"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("OR")))
});
const adapterArgsValidator = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].object({
    model: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].string(),
    where: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].optional(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].array(adapterWhereValidator)),
    sortBy: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].optional(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].object({
        field: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].string(),
        direction: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].union(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("asc"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("desc"))
    })),
    select: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].optional(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].array(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].string())),
    limit: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].optional(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].number()),
    offset: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].optional(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].number())
});
const isUniqueField = (betterAuthSchema, model, field)=>{
    const fields = betterAuthSchema[model]["fields"];
    if (!fields) {
        return false;
    }
    return Object.entries(fields).filter((param)=>{
        let [, value] = param;
        return value.unique;
    }).map((param)=>{
        let [key] = param;
        return key;
    }).includes(field);
};
const hasUniqueFields = (betterAuthSchema, model, input)=>{
    for (const field of Object.keys(input)){
        if (isUniqueField(betterAuthSchema, model, field)) {
            return true;
        }
    }
    return false;
};
const findIndex = (schema, args)=>{
    var _args_where, _args_where1, _args_where2, _args_sortBy;
    var _args_where_length;
    if (((_args_where_length = (_args_where = args.where) === null || _args_where === void 0 ? void 0 : _args_where.length) !== null && _args_where_length !== void 0 ? _args_where_length : 0) > 1 && ((_args_where1 = args.where) === null || _args_where1 === void 0 ? void 0 : _args_where1.some((w)=>w.connector === "OR"))) {
        throw new Error("OR connector not supported with multiple where statements in findIndex, split up the where statements before calling findIndex: ".concat(JSON.stringify(args.where)));
    }
    const where = (_args_where2 = args.where) === null || _args_where2 === void 0 ? void 0 : _args_where2.filter((w)=>{
        return (!w.operator || [
            "lt",
            "lte",
            "gt",
            "gte",
            "eq",
            "in"
        ].includes(w.operator)) && w.field !== "id";
    });
    if (!(where === null || where === void 0 ? void 0 : where.length) && !args.sortBy) {
        return;
    }
    var _where_filter;
    const lowerBounds = (_where_filter = where === null || where === void 0 ? void 0 : where.filter((w)=>w.operator === "lt" || w.operator === "lte")) !== null && _where_filter !== void 0 ? _where_filter : [];
    if (lowerBounds.length > 1) {
        throw new Error("cannot have more than one lower bound where clause: ".concat(JSON.stringify(where)));
    }
    var _where_filter1;
    const upperBounds = (_where_filter1 = where === null || where === void 0 ? void 0 : where.filter((w)=>w.operator === "gt" || w.operator === "gte")) !== null && _where_filter1 !== void 0 ? _where_filter1 : [];
    if (upperBounds.length > 1) {
        throw new Error("cannot have more than one upper bound where clause: ".concat(JSON.stringify(where)));
    }
    const lowerBound = lowerBounds[0];
    const upperBound = upperBounds[0];
    if (lowerBound && upperBound && lowerBound.field !== upperBound.field) {
        throw new Error("lower bound and upper bound must have the same field: ".concat(JSON.stringify(where)));
    }
    const boundField = (lowerBound === null || lowerBound === void 0 ? void 0 : lowerBound.field) || (upperBound === null || upperBound === void 0 ? void 0 : upperBound.field);
    if (boundField && (where === null || where === void 0 ? void 0 : where.some((w)=>w.field === boundField && w !== lowerBound && w !== upperBound))) {
        throw new Error("too many where clauses on the bound field: ".concat(JSON.stringify(where)));
    }
    var _where_filter_sort_map;
    const indexEqFields = (_where_filter_sort_map = where === null || where === void 0 ? void 0 : where.filter((w)=>!w.operator || w.operator === "eq").sort((a, b)=>{
        return a.field.localeCompare(b.field);
    }).map((w)=>[
            w.field,
            w.value
        ])) !== null && _where_filter_sort_map !== void 0 ? _where_filter_sort_map : [];
    if (!(indexEqFields === null || indexEqFields === void 0 ? void 0 : indexEqFields.length) && !boundField && !args.sortBy) {
        return;
    }
    const table = schema.tables[args.model];
    if (!table) {
        throw new Error("Table ".concat(args.model, " not found"));
    }
    const indexes = table[" indexes"]();
    const sortField = (_args_sortBy = args.sortBy) === null || _args_sortBy === void 0 ? void 0 : _args_sortBy.field;
    // We internally use _creationTime in place of Better Auth's createdAt
    const indexFields = indexEqFields.map((param)=>{
        let [field] = param;
        return field;
    }).concat(boundField && boundField !== "createdAt" ? "".concat(indexEqFields.length ? "_" : "").concat(boundField) : "").concat(sortField && sortField !== "createdAt" && boundField !== sortField ? "".concat(indexEqFields.length || boundField ? "_" : "").concat(sortField) : "").filter(Boolean);
    if (!indexFields.length && !boundField && !sortField) {
        return;
    }
    // Use the built in _creationTime index if bounding or sorting by createdAt
    // with no other fields
    const index = !indexFields.length ? {
        indexDescriptor: "by_creation_time",
        fields: []
    } : indexes.find((param)=>{
        let { fields } = param;
        const fieldsMatch = indexFields.every((field, idx)=>field === fields[idx]);
        // If sorting by createdAt, no intermediate fields can be on the index
        // as they may override the createdAt sort order.
        const boundFieldMatch = boundField === "createdAt" || sortField === "createdAt" ? indexFields.length === fields.length : true;
        return fieldsMatch && boundFieldMatch;
    });
    if (!index) {
        return {
            indexFields
        };
    }
    return {
        index: {
            indexDescriptor: index.indexDescriptor,
            fields: [
                ...index.fields,
                "_creationTime"
            ]
        },
        boundField,
        sortField,
        values: {
            eq: indexEqFields.map((param)=>{
                let [, value] = param;
                return value;
            }),
            lt: (lowerBound === null || lowerBound === void 0 ? void 0 : lowerBound.operator) === "lt" ? lowerBound.value : undefined,
            lte: (lowerBound === null || lowerBound === void 0 ? void 0 : lowerBound.operator) === "lte" ? lowerBound.value : undefined,
            gt: (upperBound === null || upperBound === void 0 ? void 0 : upperBound.operator) === "gt" ? upperBound.value : undefined,
            gte: (upperBound === null || upperBound === void 0 ? void 0 : upperBound.operator) === "gte" ? upperBound.value : undefined
        }
    };
};
const checkUniqueFields = async (ctx, schema, betterAuthSchema, table, input, doc)=>{
    if (!hasUniqueFields(betterAuthSchema, table, input)) {
        return;
    }
    for (const field of Object.keys(input)){
        if (!isUniqueField(betterAuthSchema, table, field)) {
            continue;
        }
        const { index } = findIndex(schema, {
            model: table,
            where: [
                {
                    field,
                    operator: "eq",
                    value: input[field]
                }
            ]
        }) || {};
        if (!index) {
            throw new Error("No index found for ".concat(table).concat(field));
        }
        const existingDoc = await ctx.db.query(table).withIndex(index.indexDescriptor, (q)=>q.eq(field, input[field])).unique();
        if (existingDoc && existingDoc._id !== (doc === null || doc === void 0 ? void 0 : doc._id)) {
            throw new Error("".concat(table, " ").concat(field, " already exists"));
        }
    }
};
const selectFields = async (doc, select)=>{
    if (!doc) {
        return null;
    }
    if (!(select === null || select === void 0 ? void 0 : select.length)) {
        return doc;
    }
    return select.reduce((acc, field)=>{
        acc[field] = doc[field];
        return acc;
    }, {});
};
// Manually filter an individual document by where clauses. This is used to
// simplify queries that can only return 0 or 1 documents, or "in" clauses that
// query multiple single documents in parallel.
const filterByWhere = (doc, where, // Optionally filter which where clauses to apply.
filterWhere)=>{
    if (!doc) {
        return false;
    }
    for (const w of where !== null && where !== void 0 ? where : []){
        if (filterWhere && !filterWhere(w)) {
            continue;
        }
        const value = doc[w.field];
        const isLessThan = (val, wVal)=>{
            if (!wVal) {
                return false;
            }
            if (!val) {
                return true;
            }
            return val < wVal;
        };
        const isGreaterThan = (val, wVal)=>{
            if (!val) {
                return false;
            }
            if (!wVal) {
                return true;
            }
            return val > wVal;
        };
        const filter = (w)=>{
            switch(w.operator){
                case undefined:
                case "eq":
                    {
                        return value === w.value;
                    }
                case "in":
                    {
                        return Array.isArray(w.value) && w.value.includes(value);
                    }
                case "lt":
                    {
                        return isLessThan(value, w.value);
                    }
                case "lte":
                    {
                        return value === w.value || isLessThan(value, w.value);
                    }
                case "gt":
                    {
                        return isGreaterThan(value, w.value);
                    }
                case "gte":
                    {
                        return value === w.value || isGreaterThan(value, w.value);
                    }
                case "ne":
                    {
                        return value !== w.value;
                    }
                case "contains":
                    {
                        return typeof value === "string" && value.includes(w.value);
                    }
                case "starts_with":
                    {
                        return typeof value === "string" && value.startsWith(w.value);
                    }
                case "ends_with":
                    {
                        return typeof value === "string" && value.endsWith(w.value);
                    }
            }
        };
        if (!filter(w)) {
            return false;
        }
    }
    return true;
};
const generateQuery = (ctx, schema, args)=>{
    var _values_eq;
    var _findIndex;
    const { index, values, boundField, indexFields } = (_findIndex = findIndex(schema, args)) !== null && _findIndex !== void 0 ? _findIndex : {};
    const query = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2d$helpers$2f$server$2f$stream$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["stream"])(ctx.db, schema).query(args.model);
    const hasValues = (values === null || values === void 0 ? void 0 : (_values_eq = values.eq) === null || _values_eq === void 0 ? void 0 : _values_eq.length) || (values === null || values === void 0 ? void 0 : values.lt) || (values === null || values === void 0 ? void 0 : values.lte) || (values === null || values === void 0 ? void 0 : values.gt) || (values === null || values === void 0 ? void 0 : values.gte);
    const indexedQuery = index && index.indexDescriptor !== "by_creation_time" ? query.withIndex(index.indexDescriptor, hasValues ? (q)=>{
        var _values_eq;
        for (const [idx, value] of ((_values_eq = values === null || values === void 0 ? void 0 : values.eq) !== null && _values_eq !== void 0 ? _values_eq : []).entries()){
            q = q.eq(index.fields[idx], value);
        }
        if (values === null || values === void 0 ? void 0 : values.lt) {
            q = q.lt(boundField, values.lt);
        }
        if (values === null || values === void 0 ? void 0 : values.lte) {
            q = q.lte(boundField, values.lte);
        }
        if (values === null || values === void 0 ? void 0 : values.gt) {
            q = q.gt(boundField, values.gt);
        }
        if (values === null || values === void 0 ? void 0 : values.gte) {
            q = q.gte(boundField, values.gte);
        }
        return q;
    } : undefined) : query;
    const orderedQuery = args.sortBy ? indexedQuery.order(args.sortBy.direction === "asc" ? "asc" : "desc") : indexedQuery;
    const filteredQuery = orderedQuery.filterWith(async (doc)=>{
        if (!index && (indexFields === null || indexFields === void 0 ? void 0 : indexFields.length)) {
            console.warn((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$common$2d$tags$2f$es$2f$stripIndent$2f$stripIndent$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__default__as__stripIndent$3e$__["stripIndent"])(_templateObject(), args.model, indexFields.join(", ")));
            // No index, handle all where clauses statically.
            return filterByWhere(doc, args.where);
        }
        return filterByWhere(doc, args.where, // Index used for all eq and range clauses, apply remaining clauses
        // incompatible with Convex statically.
        (w)=>w.operator && [
                "contains",
                "starts_with",
                "ends_with",
                "ne"
            ].includes(w.operator));
    });
    return filteredQuery;
};
const paginate = async (ctx, schema, betterAuthSchema, args)=>{
    var _args_where, _args_where1, _args_where2, _args_where3, _args_where4;
    if (args.offset) {
        throw new Error("offset not supported: ".concat(JSON.stringify(args.offset)));
    }
    if (((_args_where = args.where) === null || _args_where === void 0 ? void 0 : _args_where.some((w)=>w.connector === "OR")) && ((_args_where1 = args.where) === null || _args_where1 === void 0 ? void 0 : _args_where1.length) > 1) {
        throw new Error("OR connector not supported with multiple where statements in paginate, split up the where statements before calling paginate: ".concat(JSON.stringify(args.where)));
    }
    if ((_args_where2 = args.where) === null || _args_where2 === void 0 ? void 0 : _args_where2.some((w)=>w.field === "id" && w.operator && ![
            "eq",
            "in"
        ].includes(w.operator))) {
        throw new Error("id can only be used with eq or in operator: ".concat(JSON.stringify(args.where)));
    }
    // If any where clause is "eq" (or missing operator) on a unique field,
    // we can only return a single document, so we get it and use any other
    // where clauses as static filters.
    const uniqueWhere = (_args_where3 = args.where) === null || _args_where3 === void 0 ? void 0 : _args_where3.find((w)=>(!w.operator || w.operator === "eq") && (isUniqueField(betterAuthSchema, args.model, w.field) || w.field === "id"));
    if (uniqueWhere) {
        const { index } = findIndex(schema, {
            model: args.model,
            where: [
                uniqueWhere
            ]
        }) || {};
        const doc = uniqueWhere.field === "id" ? await ctx.db.get(uniqueWhere.value) : await ctx.db.query(args.model).withIndex(index === null || index === void 0 ? void 0 : index.indexDescriptor, (q)=>q.eq(index === null || index === void 0 ? void 0 : index.fields[0], uniqueWhere.value)).unique();
        // Apply all other clauses as static filters to our 0 or 1 result.
        if (filterByWhere(doc, args.where, (w)=>w !== uniqueWhere)) {
            return {
                page: [
                    await selectFields(doc, args.select)
                ].filter(Boolean),
                isDone: true,
                continueCursor: ""
            };
        }
        return {
            page: [],
            isDone: true,
            continueCursor: ""
        };
    }
    var _args_paginationOpts_numItems;
    const paginationOpts = {
        ...args.paginationOpts,
        // If maximumRowsRead is not at least 1 higher than numItems, bad cursors
        // and incorrect paging will result (at least with convex-test).
        maximumRowsRead: Math.max(((_args_paginationOpts_numItems = args.paginationOpts.numItems) !== null && _args_paginationOpts_numItems !== void 0 ? _args_paginationOpts_numItems : 0) + 1, 200)
    };
    // Large queries using "in" clause will crash, but these are only currently
    // possible with the organization plugin listing all members with a high
    // limit. For cases like this we need to create proper convex queries in
    // the component as an alternative to using Better Auth api's.
    const inWhere = (_args_where4 = args.where) === null || _args_where4 === void 0 ? void 0 : _args_where4.find((w)=>w.operator === "in");
    if (inWhere) {
        var _args_sortBy, _args_sortBy1;
        if (!Array.isArray(inWhere.value)) {
            throw new Error("in clause value must be an array");
        }
        // For ids, just use asyncMap + .get()
        if (inWhere.field === "id") {
            const docs = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2d$helpers$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["asyncMap"])(inWhere.value, async (value)=>{
                return ctx.db.get(value);
            });
            const filteredDocs = docs.flatMap((doc)=>doc ? [
                    doc
                ] : []).filter((doc)=>filterByWhere(doc, args.where, (w)=>w !== inWhere));
            return {
                page: filteredDocs.sort((a, b)=>{
                    var _args_sortBy;
                    if (((_args_sortBy = args.sortBy) === null || _args_sortBy === void 0 ? void 0 : _args_sortBy.field) === "createdAt") {
                        return args.sortBy.direction === "asc" ? a._creationTime - b._creationTime : b._creationTime - a._creationTime;
                    }
                    if (args.sortBy) {
                        const aValue = a[args.sortBy.field];
                        const bValue = b[args.sortBy.field];
                        if (aValue === bValue) {
                            return 0;
                        }
                        return args.sortBy.direction === "asc" ? aValue > bValue ? 1 : -1 : aValue > bValue ? -1 : 1;
                    }
                    return 0;
                }),
                isDone: true,
                continueCursor: ""
            };
        }
        const streams = inWhere.value.map((value)=>{
            var _args_where;
            return generateQuery(ctx, schema, {
                ...args,
                where: (_args_where = args.where) === null || _args_where === void 0 ? void 0 : _args_where.map((w)=>{
                    if (w === inWhere) {
                        return {
                            ...w,
                            operator: "eq",
                            value
                        };
                    }
                    return w;
                })
            });
        });
        const result = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2d$helpers$2f$server$2f$stream$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["mergedStream"])(streams, [
            ((_args_sortBy = args.sortBy) === null || _args_sortBy === void 0 ? void 0 : _args_sortBy.field) !== "createdAt" && ((_args_sortBy1 = args.sortBy) === null || _args_sortBy1 === void 0 ? void 0 : _args_sortBy1.field),
            "_creationTime"
        ].flatMap((f)=>f ? [
                f
            ] : [])).paginate(paginationOpts);
        return {
            ...result,
            page: await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2d$helpers$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["asyncMap"])(result.page, (doc)=>selectFields(doc, args.select))
        };
    }
    const query = generateQuery(ctx, schema, args);
    const result = await query.paginate(paginationOpts);
    return {
        ...result,
        page: await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2d$helpers$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["asyncMap"])(result.page, (doc)=>selectFields(doc, args.select))
    };
};
const listOne = async (ctx, schema, betterAuthSchema, args)=>{
    return (await paginate(ctx, schema, betterAuthSchema, {
        ...args,
        paginationOpts: {
            numItems: 1,
            cursor: null
        }
    })).page[0];
}; //# sourceMappingURL=adapterUtils.js.map
}),
"[project]/node_modules/@convex-dev/better-auth/dist/esm/client/index.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "createApi",
    ()=>createApi,
    "createClient",
    ()=>createClient,
    "getStaticAuth",
    ()=>getStaticAuth
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$server$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/convex/dist/esm/server/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$server$2f$impl$2f$registration_impl$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/convex/dist/esm/server/impl/registration_impl.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$server$2f$pagination$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/convex/dist/esm/server/pagination.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/convex/dist/esm/values/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/convex/dist/esm/values/validator.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$convex$2d$dev$2f$better$2d$auth$2f$dist$2f$esm$2f$client$2f$adapter$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@convex-dev/better-auth/dist/esm/client/adapter.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2d$helpers$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/convex-helpers/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$convex$2d$dev$2f$better$2d$auth$2f$dist$2f$esm$2f$utils$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@convex-dev/better-auth/dist/esm/utils/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2d$helpers$2f$validators$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/convex-helpers/validators.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$convex$2d$dev$2f$better$2d$auth$2f$dist$2f$esm$2f$client$2f$adapterUtils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@convex-dev/better-auth/dist/esm/client/adapterUtils.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2d$helpers$2f$server$2f$cors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/convex-helpers/server/cors.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/convex/dist/esm/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$semver$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/semver/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$db$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/better-auth/dist/db/index.mjs [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$B_PTVODM$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__g__as__getAuthTables$3e$__ = __turbopack_context__.i("[project]/node_modules/better-auth/dist/shared/better-auth.B_PTVODM.mjs [app-client] (ecmascript) <export g as getAuthTables>");
;
;
;
;
;
;
;
;
;
;
;
;
const getStaticAuth = (createAuth)=>{
    return createAuth({}, {
        optionsOnly: true
    });
};
if (__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$semver$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["default"].lt(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["version"], "1.25.0")) {
    throw new Error("Convex version must be at least 1.25.0");
}
const whereValidator = (schema, tableName)=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].object({
        field: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].union(...Object.keys(schema.tables[tableName].validator.fields).map((field)=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal(field)), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("id")),
        operator: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].optional(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].union(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("lt"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("lte"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("gt"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("gte"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("eq"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("in"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("ne"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("contains"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("starts_with"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("ends_with"))),
        value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].union(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].string(), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].number(), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].boolean(), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].array(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].string()), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].array(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].number()), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].null()),
        connector: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].optional(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].union(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("AND"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("OR")))
    });
const createApi = (schema, createAuth)=>{
    const betterAuthSchema = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$B_PTVODM$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__g__as__getAuthTables$3e$__["getAuthTables"])(getStaticAuth(createAuth).options);
    return {
        create: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$server$2f$impl$2f$registration_impl$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["mutationGeneric"])({
            args: {
                input: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].union(...Object.entries(schema.tables).map((param)=>{
                    let [model, table] = param;
                    return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].object({
                        model: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal(model),
                        data: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].object(table.validator.fields)
                    });
                })),
                select: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].optional(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].array(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].string())),
                onCreateHandle: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].optional(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].string())
            },
            handler: async (ctx, args)=>{
                await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$convex$2d$dev$2f$better$2d$auth$2f$dist$2f$esm$2f$client$2f$adapterUtils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["checkUniqueFields"])(ctx, schema, betterAuthSchema, args.input.model, args.input.data);
                const id = await ctx.db.insert(args.input.model, args.input.data);
                const doc = await ctx.db.get(id);
                if (!doc) {
                    throw new Error("Failed to create ".concat(args.input.model));
                }
                const result = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$convex$2d$dev$2f$better$2d$auth$2f$dist$2f$esm$2f$client$2f$adapterUtils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["selectFields"])(doc, args.select);
                if (args.onCreateHandle) {
                    await ctx.runMutation(args.onCreateHandle, {
                        model: args.input.model,
                        doc
                    });
                }
                return result;
            }
        }),
        findOne: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$server$2f$impl$2f$registration_impl$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["queryGeneric"])({
            args: {
                model: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].union(...Object.keys(schema.tables).map((model)=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal(model))),
                where: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].optional(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].array(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$convex$2d$dev$2f$better$2d$auth$2f$dist$2f$esm$2f$client$2f$adapterUtils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["adapterWhereValidator"])),
                select: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].optional(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].array(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].string()))
            },
            handler: async (ctx, args)=>{
                return await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$convex$2d$dev$2f$better$2d$auth$2f$dist$2f$esm$2f$client$2f$adapterUtils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["listOne"])(ctx, schema, betterAuthSchema, args);
            }
        }),
        findMany: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$server$2f$impl$2f$registration_impl$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["queryGeneric"])({
            args: {
                model: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].union(...Object.keys(schema.tables).map((model)=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal(model))),
                where: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].optional(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].array(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$convex$2d$dev$2f$better$2d$auth$2f$dist$2f$esm$2f$client$2f$adapterUtils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["adapterWhereValidator"])),
                limit: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].optional(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].number()),
                sortBy: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].optional(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].object({
                    direction: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].union(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("asc"), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal("desc")),
                    field: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].string()
                })),
                offset: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].optional(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].number()),
                paginationOpts: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$server$2f$pagination$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["paginationOptsValidator"]
            },
            handler: async (ctx, args)=>{
                return await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$convex$2d$dev$2f$better$2d$auth$2f$dist$2f$esm$2f$client$2f$adapterUtils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["paginate"])(ctx, schema, betterAuthSchema, args);
            }
        }),
        updateOne: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$server$2f$impl$2f$registration_impl$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["mutationGeneric"])({
            args: {
                input: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].union(...Object.entries(schema.tables).map((param)=>{
                    let [tableName, table] = param;
                    const fields = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2d$helpers$2f$validators$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["partial"])(table.validator.fields);
                    return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].object({
                        model: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal(tableName),
                        update: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].object(fields),
                        where: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].optional(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].array(whereValidator(schema, tableName)))
                    });
                })),
                onUpdateHandle: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].optional(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].string())
            },
            handler: async (ctx, args)=>{
                const doc = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$convex$2d$dev$2f$better$2d$auth$2f$dist$2f$esm$2f$client$2f$adapterUtils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["listOne"])(ctx, schema, betterAuthSchema, args.input);
                if (!doc) {
                    throw new Error("Failed to update ".concat(args.input.model));
                }
                await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$convex$2d$dev$2f$better$2d$auth$2f$dist$2f$esm$2f$client$2f$adapterUtils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["checkUniqueFields"])(ctx, schema, betterAuthSchema, args.input.model, args.input.update, doc);
                await ctx.db.patch(doc._id, args.input.update);
                const updatedDoc = await ctx.db.get(doc._id);
                if (!updatedDoc) {
                    throw new Error("Failed to update ".concat(args.input.model));
                }
                if (args.onUpdateHandle) {
                    await ctx.runMutation(args.onUpdateHandle, {
                        model: args.input.model,
                        oldDoc: doc,
                        newDoc: updatedDoc
                    });
                }
                return updatedDoc;
            }
        }),
        updateMany: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$server$2f$impl$2f$registration_impl$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["mutationGeneric"])({
            args: {
                input: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].union(...Object.entries(schema.tables).map((param)=>{
                    let [tableName, table] = param;
                    const fields = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2d$helpers$2f$validators$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["partial"])(table.validator.fields);
                    return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].object({
                        model: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal(tableName),
                        update: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].object(fields),
                        where: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].optional(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].array(whereValidator(schema, tableName)))
                    });
                })),
                paginationOpts: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$server$2f$pagination$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["paginationOptsValidator"],
                onUpdateHandle: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].optional(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].string())
            },
            handler: async (ctx, args)=>{
                const { page, ...result } = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$convex$2d$dev$2f$better$2d$auth$2f$dist$2f$esm$2f$client$2f$adapterUtils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["paginate"])(ctx, schema, betterAuthSchema, {
                    ...args.input,
                    paginationOpts: args.paginationOpts
                });
                if (args.input.update) {
                    var _args_input_update;
                    if ((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$convex$2d$dev$2f$better$2d$auth$2f$dist$2f$esm$2f$client$2f$adapterUtils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["hasUniqueFields"])(betterAuthSchema, args.input.model, (_args_input_update = args.input.update) !== null && _args_input_update !== void 0 ? _args_input_update : {}) && page.length > 1) {
                        var _args_input_update1;
                        throw new Error("Attempted to set unique fields in multiple documents in ".concat(args.input.model, " with the same value. Fields: ").concat(Object.keys((_args_input_update1 = args.input.update) !== null && _args_input_update1 !== void 0 ? _args_input_update1 : {}).join(", ")));
                    }
                    await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2d$helpers$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["asyncMap"])(page, async (doc)=>{
                        var _args_input_update;
                        await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$convex$2d$dev$2f$better$2d$auth$2f$dist$2f$esm$2f$client$2f$adapterUtils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["checkUniqueFields"])(ctx, schema, betterAuthSchema, args.input.model, (_args_input_update = args.input.update) !== null && _args_input_update !== void 0 ? _args_input_update : {}, doc);
                        await ctx.db.patch(doc._id, args.input.update);
                        if (args.onUpdateHandle) {
                            await ctx.runMutation(args.onUpdateHandle, {
                                model: args.input.model,
                                oldDoc: doc,
                                newDoc: await ctx.db.get(doc._id)
                            });
                        }
                    });
                }
                return {
                    ...result,
                    count: page.length,
                    ids: page.map((doc)=>doc._id)
                };
            }
        }),
        deleteOne: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$server$2f$impl$2f$registration_impl$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["mutationGeneric"])({
            args: {
                input: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].union(...Object.keys(schema.tables).map((tableName)=>{
                    return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].object({
                        model: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal(tableName),
                        where: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].optional(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].array(whereValidator(schema, tableName)))
                    });
                })),
                onDeleteHandle: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].optional(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].string())
            },
            handler: async (ctx, args)=>{
                const doc = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$convex$2d$dev$2f$better$2d$auth$2f$dist$2f$esm$2f$client$2f$adapterUtils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["listOne"])(ctx, schema, betterAuthSchema, args.input);
                if (!doc) {
                    return;
                }
                await ctx.db.delete(doc._id);
                if (args.onDeleteHandle) {
                    await ctx.runMutation(args.onDeleteHandle, {
                        model: args.input.model,
                        doc
                    });
                }
                return doc;
            }
        }),
        deleteMany: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$server$2f$impl$2f$registration_impl$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["mutationGeneric"])({
            args: {
                input: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].union(...Object.keys(schema.tables).map((tableName)=>{
                    return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].object({
                        model: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].literal(tableName),
                        where: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].optional(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].array(whereValidator(schema, tableName)))
                    });
                })),
                paginationOpts: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$server$2f$pagination$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["paginationOptsValidator"],
                onDeleteHandle: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].optional(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].string())
            },
            handler: async (ctx, args)=>{
                const { page, ...result } = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$convex$2d$dev$2f$better$2d$auth$2f$dist$2f$esm$2f$client$2f$adapterUtils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["paginate"])(ctx, schema, betterAuthSchema, {
                    ...args.input,
                    paginationOpts: args.paginationOpts
                });
                await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2d$helpers$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["asyncMap"])(page, async (doc)=>{
                    if (args.onDeleteHandle) {
                        await ctx.runMutation(args.onDeleteHandle, {
                            model: args.input.model,
                            doc
                        });
                    }
                    await ctx.db.delete(doc._id);
                });
                return {
                    ...result,
                    count: page.length,
                    ids: page.map((doc)=>doc._id)
                };
            }
        })
    };
};
const createClient = (component, config)=>{
    const safeGetAuthUser = async (ctx)=>{
        const identity = await ctx.auth.getUserIdentity();
        if (!identity) {
            return;
        }
        const doc = await ctx.runQuery(component.adapter.findOne, {
            model: "user",
            where: [
                {
                    field: "id",
                    value: identity.subject
                }
            ]
        });
        if (!doc) {
            return;
        }
        return doc;
    };
    return {
        component,
        adapter: (ctx)=>(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$convex$2d$dev$2f$better$2d$auth$2f$dist$2f$esm$2f$client$2f$adapter$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["convexAdapter"])(ctx, component, config),
        getHeaders: async (ctx)=>{
            const identity = await ctx.auth.getUserIdentity();
            if (!identity) {
                return new Headers();
            }
            const session = await ctx.runQuery(component.adapter.findOne, {
                model: "session",
                where: [
                    {
                        field: "userId",
                        value: identity.subject
                    }
                ]
            });
            return new Headers({
                ...(session === null || session === void 0 ? void 0 : session.token) ? {
                    authorization: "Bearer ".concat(session.token)
                } : {},
                ...(session === null || session === void 0 ? void 0 : session.ipAddress) ? {
                    "x-forwarded-for": session.ipAddress
                } : {}
            });
        },
        safeGetAuthUser,
        getAuthUser: async (ctx)=>{
            const user = await safeGetAuthUser(ctx);
            if (!user) {
                throw new Error("Unauthenticated");
            }
            return user;
        },
        getAnyUserById: async (ctx, id)=>{
            return await ctx.runQuery(component.adapter.findOne, {
                model: "user",
                where: [
                    {
                        field: "id",
                        value: id
                    }
                ]
            });
        },
        // Replaces 0.7 behavior of returning a new user id from
        // onCreateUser
        setUserId: async (ctx, authId, userId)=>{
            await ctx.runMutation(component.adapter.updateOne, {
                input: {
                    model: "user",
                    where: [
                        {
                            field: "id",
                            value: authId
                        }
                    ],
                    update: {
                        userId
                    }
                }
            });
        },
        triggersApi: ()=>({
                onCreate: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$server$2f$impl$2f$registration_impl$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["internalMutationGeneric"])({
                    args: {
                        doc: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].any(),
                        model: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].string()
                    },
                    handler: async (ctx, args)=>{
                        var _config_triggers_args_model_onCreate, _config_triggers_args_model, _config_triggers;
                        await (config === null || config === void 0 ? void 0 : (_config_triggers = config.triggers) === null || _config_triggers === void 0 ? void 0 : (_config_triggers_args_model = _config_triggers[args.model]) === null || _config_triggers_args_model === void 0 ? void 0 : (_config_triggers_args_model_onCreate = _config_triggers_args_model.onCreate) === null || _config_triggers_args_model_onCreate === void 0 ? void 0 : _config_triggers_args_model_onCreate.call(_config_triggers_args_model, ctx, args.doc));
                    }
                }),
                onUpdate: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$server$2f$impl$2f$registration_impl$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["internalMutationGeneric"])({
                    args: {
                        oldDoc: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].any(),
                        newDoc: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].any(),
                        model: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].string()
                    },
                    handler: async (ctx, args)=>{
                        var _config_triggers_args_model_onUpdate, _config_triggers_args_model, _config_triggers;
                        await (config === null || config === void 0 ? void 0 : (_config_triggers = config.triggers) === null || _config_triggers === void 0 ? void 0 : (_config_triggers_args_model = _config_triggers[args.model]) === null || _config_triggers_args_model === void 0 ? void 0 : (_config_triggers_args_model_onUpdate = _config_triggers_args_model.onUpdate) === null || _config_triggers_args_model_onUpdate === void 0 ? void 0 : _config_triggers_args_model_onUpdate.call(_config_triggers_args_model, ctx, args.oldDoc, args.newDoc));
                    }
                }),
                onDelete: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$server$2f$impl$2f$registration_impl$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["internalMutationGeneric"])({
                    args: {
                        doc: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].any(),
                        model: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$values$2f$validator$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["v"].string()
                    },
                    handler: async (ctx, args)=>{
                        var _config_triggers_args_model_onDelete, _config_triggers_args_model, _config_triggers;
                        await (config === null || config === void 0 ? void 0 : (_config_triggers = config.triggers) === null || _config_triggers === void 0 ? void 0 : (_config_triggers_args_model = _config_triggers[args.model]) === null || _config_triggers_args_model === void 0 ? void 0 : (_config_triggers_args_model_onDelete = _config_triggers_args_model.onDelete) === null || _config_triggers_args_model_onDelete === void 0 ? void 0 : _config_triggers_args_model_onDelete.call(_config_triggers_args_model, ctx, args.doc));
                    }
                })
            }),
        registerRoutes: function(http, createAuth) {
            let opts = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : {};
            const staticAuth = getStaticAuth(createAuth);
            var _staticAuth_options_basePath;
            const path = (_staticAuth_options_basePath = staticAuth.options.basePath) !== null && _staticAuth_options_basePath !== void 0 ? _staticAuth_options_basePath : "/api/auth";
            const authRequestHandler = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$server$2f$impl$2f$registration_impl$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["httpActionGeneric"])(async (ctx, request)=>{
                if (config === null || config === void 0 ? void 0 : config.verbose) {
                    console.log("options.baseURL", staticAuth.options.baseURL);
                    console.log("request headers", request.headers);
                }
                const auth = createAuth(ctx);
                const response = await auth.handler(request);
                if (config === null || config === void 0 ? void 0 : config.verbose) {
                    console.log("response headers", response.headers);
                }
                return response;
            });
            const wellKnown = http.lookup("/.well-known/openid-configuration", "GET");
            // If registerRoutes is used multiple times, this may already be defined
            if (!wellKnown) {
                // Redirect root well-known to api well-known
                http.route({
                    path: "/.well-known/openid-configuration",
                    method: "GET",
                    handler: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2f$dist$2f$esm$2f$server$2f$impl$2f$registration_impl$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["httpActionGeneric"])(async ()=>{
                        const url = "".concat((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$convex$2d$dev$2f$better$2d$auth$2f$dist$2f$esm$2f$utils$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["requireEnv"])("CONVEX_SITE_URL")).concat(path, "/convex/.well-known/openid-configuration");
                        return Response.redirect(url);
                    })
                });
            }
            if (!opts.cors) {
                http.route({
                    pathPrefix: "".concat(path, "/"),
                    method: "GET",
                    handler: authRequestHandler
                });
                http.route({
                    pathPrefix: "".concat(path, "/"),
                    method: "POST",
                    handler: authRequestHandler
                });
                return;
            }
            const corsOpts = typeof opts.cors === "boolean" ? {
                allowedOrigins: [],
                allowedHeaders: [],
                exposedHeaders: []
            } : opts.cors;
            let trustedOriginsOption;
            var _corsOpts_allowedHeaders, _corsOpts_exposedHeaders;
            const cors = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$convex$2d$helpers$2f$server$2f$cors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["corsRouter"])(http, {
                allowedOrigins: async (request)=>{
                    var _ref;
                    trustedOriginsOption = (_ref = trustedOriginsOption !== null && trustedOriginsOption !== void 0 ? trustedOriginsOption : (await staticAuth.$context).options.trustedOrigins) !== null && _ref !== void 0 ? _ref : [];
                    const trustedOrigins = Array.isArray(trustedOriginsOption) ? trustedOriginsOption : await trustedOriginsOption(request);
                    var _corsOpts_allowedOrigins;
                    return trustedOrigins.map((origin)=>// Strip trailing wildcards, unsupported for allowedOrigins
                        origin.endsWith("*") && origin.length > 1 ? origin.slice(0, -1) : origin).concat((_corsOpts_allowedOrigins = corsOpts.allowedOrigins) !== null && _corsOpts_allowedOrigins !== void 0 ? _corsOpts_allowedOrigins : []);
                },
                allowCredentials: true,
                allowedHeaders: [
                    "Content-Type",
                    "Better-Auth-Cookie"
                ].concat((_corsOpts_allowedHeaders = corsOpts.allowedHeaders) !== null && _corsOpts_allowedHeaders !== void 0 ? _corsOpts_allowedHeaders : []),
                exposedHeaders: [
                    "Set-Better-Auth-Cookie"
                ].concat((_corsOpts_exposedHeaders = corsOpts.exposedHeaders) !== null && _corsOpts_exposedHeaders !== void 0 ? _corsOpts_exposedHeaders : []),
                debug: config === null || config === void 0 ? void 0 : config.verbose,
                enforceAllowOrigins: false
            });
            cors.route({
                pathPrefix: "".concat(path, "/"),
                method: "GET",
                handler: authRequestHandler
            });
            cors.route({
                pathPrefix: "".concat(path, "/"),
                method: "POST",
                handler: authRequestHandler
            });
        }
    };
}; //# sourceMappingURL=index.js.map
}),
"[project]/node_modules/@convex-dev/better-auth/dist/esm/plugins/convex/index.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "JWT_COOKIE_NAME",
    ()=>JWT_COOKIE_NAME,
    "convex",
    ()=>convex
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$polyfills$2f$process$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = /*#__PURE__*/ __turbopack_context__.i("[project]/node_modules/next/dist/build/polyfills/process.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$api$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/better-auth/dist/api/index.mjs [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$DV5EHeYG$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__c__as__createAuthMiddleware$3e$__ = __turbopack_context__.i("[project]/node_modules/better-auth/dist/shared/better-auth.DV5EHeYG.mjs [app-client] (ecmascript) <export c as createAuthMiddleware>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$DV5EHeYG$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__s__as__sessionMiddleware$3e$__ = __turbopack_context__.i("[project]/node_modules/better-auth/dist/shared/better-auth.DV5EHeYG.mjs [app-client] (ecmascript) <export s as sessionMiddleware>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$plugins$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/better-auth/dist/plugins/index.mjs [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$DV5EHeYG$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__a__as__createAuthEndpoint$3e$__ = __turbopack_context__.i("[project]/node_modules/better-auth/dist/shared/better-auth.DV5EHeYG.mjs [app-client] (ecmascript) <export a as createAuthEndpoint>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$plugins$2f$jwt$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/better-auth/dist/plugins/jwt/index.mjs [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$plugins$2f$bearer$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/better-auth/dist/plugins/bearer/index.mjs [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$DIVj9vPt$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__o__as__oidcProvider$3e$__ = __turbopack_context__.i("[project]/node_modules/better-auth/dist/shared/better-auth.DIVj9vPt.mjs [app-client] (ecmascript) <export o as oidcProvider>");
;
;
const JWT_COOKIE_NAME = "convex_jwt";
const convex = function() {
    let opts = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {};
    var _opts_options;
    const { jwtExpirationSeconds = 60 * 15 } = opts;
    var _opts_options_basePath;
    const oidcProvider = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$DIVj9vPt$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__o__as__oidcProvider$3e$__["oidcProvider"])({
        loginPage: "/not-used",
        metadata: {
            issuer: "".concat(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$polyfills$2f$process$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["default"].env.CONVEX_SITE_URL),
            jwks_uri: "".concat(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$polyfills$2f$process$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["default"].env.CONVEX_SITE_URL).concat((_opts_options_basePath = (_opts_options = opts.options) === null || _opts_options === void 0 ? void 0 : _opts_options.basePath) !== null && _opts_options_basePath !== void 0 ? _opts_options_basePath : "/api/auth", "/convex/jwks")
        }
    });
    const jwt = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$plugins$2f$jwt$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["jwt"])({
        jwt: {
            issuer: "".concat(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$polyfills$2f$process$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["default"].env.CONVEX_SITE_URL),
            audience: "convex",
            expirationTime: "".concat(jwtExpirationSeconds, "s"),
            // eslint-disable-next-line @typescript-eslint/no-unused-vars
            definePayload: (param)=>{
                let { user: { id, image, ...user }, session } = param;
                return {
                    ...user,
                    sessionId: session.id,
                    iat: Math.floor(new Date().getTime() / 1000)
                };
            }
        }
    });
    // Bearer plugin converts the session token to a cookie
    // for cross domain social login after code verification,
    // and is required for the headers() helper to work.
    const bearer = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$plugins$2f$bearer$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["bearer"])();
    const schema = {
        user: {
            fields: {
                userId: {
                    type: "string",
                    required: false,
                    input: false
                }
            }
        },
        ...jwt.schema
    };
    return {
        id: "convex",
        init: (param)=>{
            let { logger, options } = param;
            var _options_plugins;
            if (((_options_plugins = options.plugins) === null || _options_plugins === void 0 ? void 0 : _options_plugins.every((p)=>p.id !== "cross-domain")) && !options.baseURL) {
                logger.warn("Better Auth baseURL is undefined. This is probably a mistake.");
            }
        },
        hooks: {
            before: [
                ...bearer.hooks.before
            ],
            after: [
                ...oidcProvider.hooks.after,
                {
                    matcher: (ctx)=>{
                        return ctx.path.startsWith("/sign-in") || ctx.path.startsWith("/sign-up") || ctx.path.startsWith("/callback") || ctx.path.startsWith("/oauth2/callback") || ctx.path.startsWith("/magic-link/verify") || ctx.path.startsWith("/email-otp/verify-email") || ctx.path.startsWith("/phone-number/verify");
                    },
                    handler: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$DV5EHeYG$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__c__as__createAuthMiddleware$3e$__["createAuthMiddleware"])(async (ctx)=>{
                        var _ctx_context_responseHeaders;
                        var _ctx_context_responseHeaders_get;
                        // Set jwt cookie at login for ssa
                        const cookie = (_ctx_context_responseHeaders_get = (_ctx_context_responseHeaders = ctx.context.responseHeaders) === null || _ctx_context_responseHeaders === void 0 ? void 0 : _ctx_context_responseHeaders.get("set-cookie")) !== null && _ctx_context_responseHeaders_get !== void 0 ? _ctx_context_responseHeaders_get : "";
                        if (!cookie) {
                            return;
                        }
                        try {
                            const { token } = await jwt.endpoints.getToken({
                                ...ctx,
                                method: "GET",
                                headers: {
                                    cookie
                                },
                                returnHeaders: false
                            });
                            const jwtCookie = ctx.context.createAuthCookie(JWT_COOKIE_NAME, {
                                maxAge: jwtExpirationSeconds
                            });
                            ctx.setCookie(jwtCookie.name, token, jwtCookie.attributes);
                        } catch (_err) {
                        // no-op, some sign-in calls (eg., when redirecting to 2fa)
                        // 401 here
                        }
                    })
                },
                {
                    matcher: (ctx)=>{
                        var _ctx_path, _ctx_path1;
                        return ((_ctx_path = ctx.path) === null || _ctx_path === void 0 ? void 0 : _ctx_path.startsWith("/sign-out")) || ((_ctx_path1 = ctx.path) === null || _ctx_path1 === void 0 ? void 0 : _ctx_path1.startsWith("/delete-user"));
                    },
                    handler: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$DV5EHeYG$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__c__as__createAuthMiddleware$3e$__["createAuthMiddleware"])(async (ctx)=>{
                        const jwtCookie = ctx.context.createAuthCookie(JWT_COOKIE_NAME, {
                            maxAge: 0
                        });
                        ctx.setCookie(jwtCookie.name, "", jwtCookie.attributes);
                    })
                }
            ]
        },
        endpoints: {
            getOpenIdConfig: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$DV5EHeYG$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__a__as__createAuthEndpoint$3e$__["createAuthEndpoint"])("/convex/.well-known/openid-configuration", {
                method: "GET",
                metadata: {
                    isAction: false
                }
            }, async (ctx)=>{
                const response = await oidcProvider.endpoints.getOpenIdConfig({
                    ...ctx,
                    returnHeaders: false
                });
                return response;
            }),
            getJwks: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$DV5EHeYG$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__a__as__createAuthEndpoint$3e$__["createAuthEndpoint"])("/convex/jwks", {
                method: "GET",
                metadata: {
                    openapi: {
                        description: "Get the JSON Web Key Set",
                        responses: {
                            "200": {
                                description: "JSON Web Key Set retrieved successfully",
                                content: {
                                    "application/json": {
                                        schema: {
                                            type: "object",
                                            properties: {
                                                keys: {
                                                    type: "array",
                                                    description: "Array of public JSON Web Keys",
                                                    items: {
                                                        type: "object",
                                                        properties: {
                                                            kid: {
                                                                type: "string",
                                                                description: "Key ID uniquely identifying the key, corresponds to the 'id' from the stored Jwk"
                                                            },
                                                            kty: {
                                                                type: "string",
                                                                description: "Key type (e.g., 'RSA', 'EC', 'OKP')"
                                                            },
                                                            alg: {
                                                                type: "string",
                                                                description: "Algorithm intended for use with the key (e.g., 'EdDSA', 'RS256')"
                                                            },
                                                            use: {
                                                                type: "string",
                                                                description: "Intended use of the public key (e.g., 'sig' for signature)",
                                                                enum: [
                                                                    "sig"
                                                                ],
                                                                nullable: true
                                                            },
                                                            n: {
                                                                type: "string",
                                                                description: "Modulus for RSA keys (base64url-encoded)",
                                                                nullable: true
                                                            },
                                                            e: {
                                                                type: "string",
                                                                description: "Exponent for RSA keys (base64url-encoded)",
                                                                nullable: true
                                                            },
                                                            crv: {
                                                                type: "string",
                                                                description: "Curve name for elliptic curve keys (e.g., 'Ed25519', 'P-256')",
                                                                nullable: true
                                                            },
                                                            x: {
                                                                type: "string",
                                                                description: "X coordinate for elliptic curve keys (base64url-encoded)",
                                                                nullable: true
                                                            },
                                                            y: {
                                                                type: "string",
                                                                description: "Y coordinate for elliptic curve keys (base64url-encoded)",
                                                                nullable: true
                                                            }
                                                        },
                                                        required: [
                                                            "kid",
                                                            "kty",
                                                            "alg"
                                                        ]
                                                    }
                                                }
                                            },
                                            required: [
                                                "keys"
                                            ]
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }, async (ctx)=>{
                const response = await jwt.endpoints.getJwks({
                    ...ctx,
                    returnHeaders: false
                });
                return response;
            }),
            getToken: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$DV5EHeYG$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__a__as__createAuthEndpoint$3e$__["createAuthEndpoint"])("/convex/token", {
                method: "GET",
                requireHeaders: true,
                use: [
                    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$DV5EHeYG$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__s__as__sessionMiddleware$3e$__["sessionMiddleware"]
                ],
                metadata: {
                    openapi: {
                        description: "Get a JWT token",
                        responses: {
                            200: {
                                description: "Success",
                                content: {
                                    "application/json": {
                                        schema: {
                                            type: "object",
                                            properties: {
                                                token: {
                                                    type: "string"
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }, async (ctx)=>{
                const response = await jwt.endpoints.getToken({
                    ...ctx,
                    returnHeaders: false
                });
                const jwtCookie = ctx.context.createAuthCookie(JWT_COOKIE_NAME, {
                    maxAge: jwtExpirationSeconds
                });
                ctx.setCookie(jwtCookie.name, response.token, jwtCookie.attributes);
                return response;
            })
        },
        schema
    };
}; //# sourceMappingURL=index.js.map
}),
"[project]/node_modules/@convex-dev/better-auth/dist/esm/plugins/cross-domain/index.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "crossDomain",
    ()=>crossDomain
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$cookies$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/better-auth/dist/cookies/index.mjs [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$UfVWArIB$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__s__as__setSessionCookie$3e$__ = __turbopack_context__.i("[project]/node_modules/better-auth/dist/shared/better-auth.UfVWArIB.mjs [app-client] (ecmascript) <export s as setSessionCookie>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$crypto$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/better-auth/dist/crypto/index.mjs [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$B4Qoxdgc$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__g__as__generateRandomString$3e$__ = __turbopack_context__.i("[project]/node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs [app-client] (ecmascript) <export g as generateRandomString>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$plugins$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/better-auth/dist/plugins/index.mjs [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$DV5EHeYG$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__a__as__createAuthEndpoint$3e$__ = __turbopack_context__.i("[project]/node_modules/better-auth/dist/shared/better-auth.DV5EHeYG.mjs [app-client] (ecmascript) <export a as createAuthEndpoint>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$DV5EHeYG$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__c__as__createAuthMiddleware$3e$__ = __turbopack_context__.i("[project]/node_modules/better-auth/dist/shared/better-auth.DV5EHeYG.mjs [app-client] (ecmascript) <export c as createAuthMiddleware>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$B$2d$Ud$2d$fSV$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__o__as__oneTimeToken$3e$__ = __turbopack_context__.i("[project]/node_modules/better-auth/dist/shared/better-auth.B-Ud-fSV.mjs [app-client] (ecmascript) <export o as oneTimeToken>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$convex$2d$dev$2f$better$2d$auth$2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__ = __turbopack_context__.i("[project]/node_modules/@convex-dev/better-auth/node_modules/zod/v3/external.js [app-client] (ecmascript) <export * as z>");
;
;
;
;
const crossDomain = (param)=>{
    let { siteUrl } = param;
    const oneTimeToken = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$B$2d$Ud$2d$fSV$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__o__as__oneTimeToken$3e$__["oneTimeToken"])();
    const rewriteCallbackURL = (callbackURL)=>{
        if (callbackURL && !callbackURL.startsWith("/")) {
            return callbackURL;
        }
        const relativeCallbackURL = callbackURL || "/";
        return new URL(relativeCallbackURL, siteUrl).toString();
    };
    return {
        id: "cross-domain",
        // TODO: remove this in the next minor release, it doesn't
        // actually affect ctx.trustedOrigins. cors allowedOrigins
        // is using it, via options.trustedOrigins, though, so it's
        // a breaking change.
        init () {
            return {
                options: {
                    trustedOrigins: [
                        siteUrl
                    ]
                }
            };
        },
        hooks: {
            before: [
                {
                    matcher (context) {
                        var _context_request, _context_headers;
                        return Boolean(((_context_request = context.request) === null || _context_request === void 0 ? void 0 : _context_request.headers.get("better-auth-cookie")) || ((_context_headers = context.headers) === null || _context_headers === void 0 ? void 0 : _context_headers.get("better-auth-cookie")));
                    },
                    handler: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$DV5EHeYG$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__c__as__createAuthMiddleware$3e$__["createAuthMiddleware"])(async (c)=>{
                        var _c_request;
                        const existingHeaders = ((_c_request = c.request) === null || _c_request === void 0 ? void 0 : _c_request.headers) || c.headers;
                        const headers = new Headers({
                            ...Object.fromEntries(existingHeaders === null || existingHeaders === void 0 ? void 0 : existingHeaders.entries())
                        });
                        // Skip if the request has an authorization header
                        if (headers.get("authorization")) {
                            return;
                        }
                        const cookie = headers.get("better-auth-cookie");
                        if (!cookie) {
                            return;
                        }
                        headers.append("cookie", cookie);
                        return {
                            context: {
                                headers
                            }
                        };
                    })
                },
                {
                    matcher: (ctx)=>{
                        return ctx.method === "GET" && ctx.path.startsWith("/verify-email");
                    },
                    handler: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$DV5EHeYG$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__c__as__createAuthMiddleware$3e$__["createAuthMiddleware"])(async (ctx)=>{
                        var _ctx_query;
                        if ((_ctx_query = ctx.query) === null || _ctx_query === void 0 ? void 0 : _ctx_query.callbackURL) {
                            ctx.query.callbackURL = rewriteCallbackURL(ctx.query.callbackURL);
                        }
                        return {
                            context: ctx
                        };
                    })
                },
                {
                    matcher: (ctx)=>{
                        return ctx.method === "POST" && ctx.path.startsWith("/link-social") || ctx.path.startsWith("/send-verification-email") || ctx.path.startsWith("/sign-in/email") || ctx.path.startsWith("/sign-in/social") || ctx.path.startsWith("/sign-in/magic-link") || ctx.path.startsWith("/delete-user") || ctx.path.startsWith("/change-email");
                    },
                    handler: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$DV5EHeYG$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__c__as__createAuthMiddleware$3e$__["createAuthMiddleware"])(async (ctx)=>{
                        const isSignIn = ctx.path.startsWith("/sign-in");
                        ctx.body.callbackURL = rewriteCallbackURL(ctx.body.callbackURL);
                        if (isSignIn && ctx.body.newUserCallbackURL) {
                            ctx.body.newUserCallbackURL = rewriteCallbackURL(ctx.body.newUserCallbackURL);
                        }
                        if (isSignIn && ctx.body.errorCallbackURL) {
                            ctx.body.errorCallbackURL = rewriteCallbackURL(ctx.body.errorCallbackURL);
                        }
                        return {
                            context: ctx
                        };
                    })
                }
            ],
            after: [
                {
                    matcher () {
                        return true;
                    },
                    handler: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$DV5EHeYG$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__c__as__createAuthMiddleware$3e$__["createAuthMiddleware"])(async (ctx)=>{
                        var _ctx_context_responseHeaders, _ctx_context_responseHeaders1;
                        const setCookie = (_ctx_context_responseHeaders = ctx.context.responseHeaders) === null || _ctx_context_responseHeaders === void 0 ? void 0 : _ctx_context_responseHeaders.get("set-cookie");
                        if (!setCookie) {
                            return;
                        }
                        (_ctx_context_responseHeaders1 = ctx.context.responseHeaders) === null || _ctx_context_responseHeaders1 === void 0 ? void 0 : _ctx_context_responseHeaders1.delete("set-cookie");
                        ctx.setHeader("Set-Better-Auth-Cookie", setCookie);
                    })
                },
                {
                    matcher: (ctx)=>{
                        var _ctx_path, _ctx_path1, _ctx_path2;
                        return ((_ctx_path = ctx.path) === null || _ctx_path === void 0 ? void 0 : _ctx_path.startsWith("/callback")) || ((_ctx_path1 = ctx.path) === null || _ctx_path1 === void 0 ? void 0 : _ctx_path1.startsWith("/oauth2/callback")) || ((_ctx_path2 = ctx.path) === null || _ctx_path2 === void 0 ? void 0 : _ctx_path2.startsWith("/magic-link/verify"));
                    },
                    handler: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$DV5EHeYG$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__c__as__createAuthMiddleware$3e$__["createAuthMiddleware"])(async (ctx)=>{
                        var _ctx_context_responseHeaders;
                        // Mostly copied from the one-time-token plugin
                        const session = ctx.context.newSession;
                        if (!session) {
                            ctx.context.logger.error("No session found");
                            return;
                        }
                        const token = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$B4Qoxdgc$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__g__as__generateRandomString$3e$__["generateRandomString"])(32);
                        const expiresAt = new Date(Date.now() + 3 * 60 * 1000);
                        await ctx.context.internalAdapter.createVerificationValue({
                            value: session.session.token,
                            identifier: "one-time-token:".concat(token),
                            expiresAt
                        });
                        const redirectTo = (_ctx_context_responseHeaders = ctx.context.responseHeaders) === null || _ctx_context_responseHeaders === void 0 ? void 0 : _ctx_context_responseHeaders.get("location");
                        if (!redirectTo) {
                            ctx.context.logger.error("No redirect to found");
                            return;
                        }
                        const url = new URL(redirectTo);
                        url.searchParams.set("ott", token);
                        throw ctx.redirect(url.toString());
                    })
                }
            ]
        },
        endpoints: {
            verifyOneTimeToken: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$DV5EHeYG$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__a__as__createAuthEndpoint$3e$__["createAuthEndpoint"])("/cross-domain/one-time-token/verify", {
                method: "POST",
                body: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$convex$2d$dev$2f$better$2d$auth$2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
                    token: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$convex$2d$dev$2f$better$2d$auth$2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string()
                })
            }, async (ctx)=>{
                const response = await oneTimeToken.endpoints.verifyOneTimeToken({
                    ...ctx,
                    returnHeaders: false
                });
                await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$UfVWArIB$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__s__as__setSessionCookie$3e$__["setSessionCookie"])(ctx, response);
                return response;
            })
        }
    };
}; //# sourceMappingURL=index.js.map
}),
"[project]/node_modules/@convex-dev/better-auth/dist/esm/plugins/index.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$convex$2d$dev$2f$better$2d$auth$2f$dist$2f$esm$2f$plugins$2f$convex$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@convex-dev/better-auth/dist/esm/plugins/convex/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$convex$2d$dev$2f$better$2d$auth$2f$dist$2f$esm$2f$plugins$2f$cross$2d$domain$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@convex-dev/better-auth/dist/esm/plugins/cross-domain/index.js [app-client] (ecmascript)"); //# sourceMappingURL=index.js.map
;
;
}),
]);

//# sourceMappingURL=node_modules_%40convex-dev_better-auth_dist_esm_3c12559c._.js.map